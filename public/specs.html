<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>開発仕様 - AI PM Dashboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header id="header-placeholder" class="app-header"></header>

    <main class="container">
        <div class="static-page-container">
            <h1>「AI Product Manager Dashboard」開発仕様書</h1>
            <p>最終更新日: 2025年8月12日</p>
    
            <h2>1. 概要</h2>
            <p>本アプリケーションは、AIプロダクトマネージャーを目指すユーザーが必要とする、最新のAI関連情報を戦略的な視点から収集・分析し、ダッシュボード形式で提供するWebアプリケーションです。</p>
    
            <h2>2. アーキテクチャ</h2>
            <p>トップページ(`/`)は静的なツールマップを、`/news.html`ページは動的な最新ニュースを表示します。それぞれがCloud Run上の異なるエンドポイントを呼び出します。</p>
            
            <h2>3. 技術スタックと利用Googleサービス</h2>
            <ul>
                <li><strong>バックエンド</strong>: Python, Flask, Gunicorn</li>
                <li><strong>フロントエンド</strong>: HTML, CSS, JavaScript</li>
                <li><strong>主要Google Cloudサービス</strong>:
                    <ul>
                        <li><strong>Cloud Run</strong>: バックエンドAPIの実行環境。</li>
                        <li><strong>Firebase Hosting</strong>: フロントエンドのホスティング。</li>
                        <li><strong>Gemini API</strong>: ニュースのPM視点での分析。</li>
                        <li><strong>Cloud Build / Artifact Registry</strong>: コンテナのビルドと保存。</li>
                    </ul>
                </li>
            </ul>
    
            <h2>4. 保守・運用手順</h2>
            <h3>4.1. 認証の再ログイン（セッション切れ対応）</h3>
            <p>Cloud Shellは一定時間でログアウトします。デプロイ等で認証エラーが出た場合は、以下のコマンドをターミナルで実行してください。</p>
            
            <h4>gcloudコマンドの再認証</h4>
            <pre><code>gcloud auth login --no-auth-browser</code></pre>
            
            <h4>firebaseコマンドの再認証</h4>
            <pre><code>firebase login --no-localhost</code></pre>
            <p>上記コマンド実行後、ターミナルに表示されるURLをブラウザで開き、画面に表示された認証コードをターミナルに貼り付けてください。</p>

            <h2>5. トラブルシューティング</h2>
            <h3>5.1. デプロイ時に `Container Healthcheck failed` エラーが頻発する</h3>
            <ul>
                <li><strong>症状</strong>: `gcloud run deploy` を実行すると、コンテナのヘルスチェックで失敗し、デプロイが完了しない。</li>
                <li><strong>原因</strong>: プロジェクトのAPIが有効になっていない、権限が不足している、請求先アカウントが有効化されていない、など環境側の問題がほとんど。</li>
                <li><strong>解決策</strong>:
                    <ol>
                        <li>Cloud Run, Cloud Build, Artifact Registry 等の関連APIが有効になっているか確認する。</li>
                        <li>IAMで主要なサービスアカウントに「編集者」などの適切な権限があるか確認する。</li>
                        <li>請求先アカウントが有効（アクティベート済み）になっているか確認する。</li>
                        <li>上記全てを確認しても解決しない場合、新しいクリーンなプロジェクトで試すのが最も確実。</li>
                    </ol>
                </li>
            </ul>

            <h3>5.2. RSSフィード取得時に `TypeError: ... unexpected keyword argument 'socket_timeout'` エラーが出る</h3>
            <ul>
                <li><strong>症状</strong>: Cloud Runのログに `socket_timeout` に関するTypeErrorが出力され、ニュースが表示されない。</li>
                <li><strong>原因</strong>: バックエンドの`main.py`内で、`feedparser`ライブラリがサポートしていない`socket_timeout`引数を指定してしまっている。</li>
                <li><strong>解決策</strong>: `main.py`内の`feedparser.parse()`の呼び出しから、`socket_timeout`引数を完全に削除する。</li>
            </ul>
            </div>
    </main>

    <script src="app.js"></script>
</body>
</html>